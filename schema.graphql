type ReferralStatus @entity(immutable: false) {
  id: Bytes!
  totalUsers: Int!
  totalGroups: Int!
}

type GroupMlrtPoolStatus @entity(immutable: false) {
  id: Bytes!
  group: ReferralGroup!
  mlrt: TrackedMLRT!
  totalTvl: BigInt!
  totalAmount: BigInt!
  totalUnmintedTvl: BigInt!
  totalUnmintedMlrt: BigInt!
  accumulateEigenLayerPoints: BigInt!
  accumulateEigenpiePoints: BigInt!
  accEigenLayerPointPerShare: BigInt!
  accEigenpiePointPerShare: BigInt!
  lastUpdateTimestamp: BigInt!
}

type GroupPartnerLpStatus @entity(immutable: false) {
  id: Bytes! # hash(group, lp address)
  group: ReferralGroup!
  prtotcol: String!
  lpAddress: Bytes!
  totalAmount: BigInt!
  accumulateEigenLayerPoints: BigInt!
  accumulateEigenpiePoints: BigInt!
  accEigenLayerPointPerShare: BigInt!
  accEigenpiePointPerShare: BigInt!
  lastUpdateTimestamp: BigInt!
}

type PartnerLpStatus @entity(immutable: false) {
  id: Bytes!
  holdingGroups: [GroupPartnerLpStatus!]!
}

type UserData @entity {
  id: Bytes!
  referrer: Bytes!
  referralGroup: ReferralGroup!
  referralCount: Int!
  mLrtPools: [UserPoolDepositData!]! @derivedFrom(field: "user")
  curvePools: [UserPartnerLpDepositData!]! @derivedFrom(field: "user")
  # rangePools
}

type UserPoolDepositData @entity {
  id: Bytes!
  user: UserData!
  mlrt: TrackedMLRT!
  mlrtAmount: BigInt!
  unmintedMlrt: BigInt!
  eigenLayerPoints: BigInt!
  eigenpiePoints: BigInt!
  eigenLayerPointsDebt: BigInt!
  eigenpiePointsDebt: BigInt!
}

type UserPartnerLpDepositData @entity {
  id: Bytes!
  user: UserData!
  prtotcol: String!
  lpAddress: Bytes!
  lpAmount: BigInt!
  eigenLayerPoints: BigInt!
  eigenpiePoints: BigInt!
  eigenLayerPointsDebt: BigInt!
  eigenpiePointsDebt: BigInt!
}

type ReferralGroup @entity {
  id: Bytes!
  members: [UserData!]! @derivedFrom(field: "referralGroup")
  mlrtPoolStatus: [GroupMlrtPoolStatus!]! @derivedFrom(field: "group")
  groupTVL: BigInt!
  groupBoost: BigInt!
}

type TrackedMLRT @entity(immutable: true) {
  id: Bytes!
  underlying: Bytes!
  strategy: Bytes!
  addedTimestamp: BigInt!
}